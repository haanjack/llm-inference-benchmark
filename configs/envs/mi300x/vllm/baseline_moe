#!/bin/bash

MODEL_PATH=""
VLLM_IMAGE=""

QUANTIZATION=auto
KV_CACHE_DTYPE=auto

# VLLM control environment variables
VLLM_USE_V1=1
VLLM_V1_USE_PREFILL_DECODE_ATTENTION=1
# AMDGCN_USE_BUFFER_OPS=1
VLLM_USE_AITER_TRITON_ROPE=1
# TRITON_HIP_ASYNC_COPY_BYPASS_PERMUTE=1
# TRITON_HIP_USE_ASYNC_COPY=1
# TRITON_HIP_USE_BLOCK_PINGPONG=1
# TRITON_HIP_ASYNC_FAST_SWIZZLE=1
VLLM_ROCM_USE_AITER=1
VLLM_ROCM_USE_AITER_MHA=0
VLLM_ROCM_USE_AITER_RMSNORM=1

# Host Environments
SAFETENSORS_FAST_GPU=1
OMP_NUM_THREADS=128
NCCL_MIN_NCHANNELS=112
HIP_FORCE_DEV_KERNARG=1

# MoE
VLLM_USE_AITER_UNIFIED_ATTENTION=1
VLLM_USE_AITER_TRITON_GEMM=1
VLLM_ROCM_USE_AITER_MHA=0
# VLLM_USE_AITER_TRITON_FUSED_SPLIT_QKV_ROPE=1
# VLLM_USE_AITER_TRITON_FUSED_ADD_RMSNORM_PAD=1
# TRITON_HIP_PRESHUFFLE_SCALES=1
# VLLM_DISABLE_COMPILE_CACHE=1
# HSA_NO_SCRATCH_RECLAIM=1
VLLM_CUDAGRAPH_MODE="MOE"


# Request Settings
MAX_NUM_SEQS=128
REQUEST_RATE=inf
NUM_ITERATION=8

# Parallelism Settings
TENSOR_PARALLEL_SIZE=1
PIPELINE_PARALLEL_SIZE=1

# Server Arguments
GPU_MEMORY_UTILIZATION=0.9

# Model Stored Path
HF_HOME=${HOME}/models
